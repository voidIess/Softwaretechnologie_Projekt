<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

    <script th:src="@{/webjars/jquery/jquery.min.js}"
            src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script th:src="@{/webjars/Semantic-UI/semantic.min.js}"
            src="http://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.js"></script>
    <link rel="stylesheet" href="http://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.css" type="text/css"/>
    <link th:href="@{/resources/css/style.css}" rel="stylesheet"
          href="../static/resources/css/style.css" type="text/css"/>
    <link rel="stylesheet" type="text/css" th:href="@{/resources/css/toggle.css}"/>

    <title>Anwesenheitsstatistik</title>

    <script>
        window.onload = function () {

            const today = new Date();
            today.setHours(0, 0, 0, 0);

            var chart1 = new CanvasJS.Chart("chartContainer1", {
                animationEnabled: true,
                title: {
                    text: "Wöchentliche Trainingsanalyse"
                },
                axisX: {
                    valueFormatString: "DDD",
                    minimum: new Date(new Date().setDate(today.getDate()-6)).setHours(0,0,0,0),
                    maximum: today
                },
                axisY: {
                    title: "Zeit in Minuten"
                },
                legend: {
                    verticalAlign: "top",
                    horizontalAlign: "right",
                    dockInsidePlotArea: true
                },
                toolTip: {
                    shared: true
                },
                data: [{
                    name: "durchschnittlicher Aufenthalt",
                    showInLegend: true,
                    type: "area",
                    color: "rgba(40,175,101,0.6)",
                    dataPoints: [
                        { x: new Date(new Date().setDate(today.getDate()-6)).setHours(0,0,0,0), y: [[${averageTimesOfLastWeek[6]}]] },
                        { x: new Date(new Date().setDate(today.getDate()-5)).setHours(0,0,0,0), y: [[${averageTimesOfLastWeek[5]}]] },
                        { x: new Date(new Date().setDate(today.getDate()-4)).setHours(0,0,0,0), y: [[${averageTimesOfLastWeek[4]}]] },
                        { x: new Date(new Date().setDate(today.getDate()-3)).setHours(0,0,0,0), y: [[${averageTimesOfLastWeek[3]}]] },
                        { x: new Date(new Date().setDate(today.getDate()-2)).setHours(0,0,0,0), y: [[${averageTimesOfLastWeek[2]}]] },
                        { x: new Date(new Date().setDate(today.getDate()-1)).setHours(0,0,0,0), y: [[${averageTimesOfLastWeek[1]}]] },
                        { x: today, y: [[${averageTimesOfLastWeek[0]}]] }
                    ]
                }]
            });

            var chart2 = new CanvasJS.Chart("chartContainer2", {
                animationEnabled: true,
                title: {
                    text: "Wöchentliche Mitgliederanalyse"
                },
                axisX: {
                    valueFormatString: "DDD",
                    minimum: new Date(new Date().setDate(today.getDate()-6)).setHours(0,0,0,0),
                    maximum: today
                },
                axisY: {
                    title: "Anzahl der Mitglieder"
                },
                legend: {
                    verticalAlign: "top",
                    horizontalAlign: "right",
                    dockInsidePlotArea: true
                },
                toolTip: {
                    shared: true
                },
                data: [{
                        name: "anwesende Mitglieder",
                        showInLegend: true,
                        legendMarkerType: "square",
                        type: "area",
                        color: "rgba(0,75,141,0.7)",
                        markerSize: 0,
                        dataPoints: [
                            { x: new Date(new Date().setDate(today.getDate()-6)).setHours(0,0,0,0), y: [[${memberAmountsOfLastWeek[6]}]] },
                            { x: new Date(new Date().setDate(today.getDate()-5)).setHours(0,0,0,0), y: [[${memberAmountsOfLastWeek[5]}]] },
                            { x: new Date(new Date().setDate(today.getDate()-4)).setHours(0,0,0,0), y: [[${memberAmountsOfLastWeek[4]}]] },
                            { x: new Date(new Date().setDate(today.getDate()-3)).setHours(0,0,0,0), y: [[${memberAmountsOfLastWeek[3]}]] },
                            { x: new Date(new Date().setDate(today.getDate()-2)).setHours(0,0,0,0), y: [[${memberAmountsOfLastWeek[2]}]] },
                            { x: new Date(new Date().setDate(today.getDate()-1)).setHours(0,0,0,0), y: [[${memberAmountsOfLastWeek[1]}]] },
                            { x: today, y: [[${memberAmountsOfLastWeek[0]}]] }
                        ]
                    }]
            });

            chart1.render();
            chart2.render();

        }
    </script>

</head>

<body>

<div class="ui container">
    <nav th:include="navigation :: navigation"></nav>
    <nav th:include="toggle :: toggle"></nav>
    <header>
        <h1>Statistik Anwesenheiten</h1>
    </header>
    <div class="ui items">
        <p>Heutige Besucheranzahl:
            <span th:text="${memberAmountsOfLastWeek[0]}">3</span>
        </p>
        <p>Heutiger durchschnittlicher Aufenthalt:
            <span th:text="${averageTimesOfLastWeek[0]}">2</span>
             Minuten
        </p>
    </div>

    <div id="chartContainer1" style="height: 370px; width: 100%; margin-top:75pt"></div>
    <div id="chartContainer2" style="height: 370px; width: 100%; margin-top:75pt"></div>

    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>


</div>



</body>
</html>